---
layout: post
title: Problems with Virtual Server on Vista
date: 2006-12-12 16:40:05.000000000 +11:00
type: post
published: true
status: publish
categories: []
tags:
- programming
meta:
  _oembed_6923fe3b77b7e1f7aed1e4d1580d1950: '{{unknown}}'
author:
  login: aabs
  email: matthews.andrew@gmail.com
  display_name: Andrew Matthews
  first_name: Andrew
  last_name: Matthews
---
<p>I recently installed Vista on my laptop and needed to install Virtual Server 2005 R2. I ran into loads of problems, such as "std::wstring::find() failed" and "LsaRegisterLogonProcess()" failed.</p>
<p>If you experience any of those problems, please check that you have done the following:</p>
<ul>
<li>Done all of the recommendations in this post: <a href="http://blogs.technet.com/mattmcspirit/archive/2006/10/18/running-virtual-server-on-vista.aspx?CommentPosted=true#commentmessage">http://blogs.technet.com/mattmcspirit/archive/2006/10/18/running-virtual-server-on-vista.aspx?CommentPosted=true#commentmessage</a>
		</li>
<li>Set up the VirtualServer virtual directory to use the "Classic .NET AppPool"
</li>
<li>Check that the Classic .NET AppPool is using LocalSystem identity
</li>
<li>Check that ONLY Windows Authentication is set for the  virtual directory. This was a killer for me, because I didn't realize that IIS7 will just pick the first authentication mechanism it comes upon. So if Anonymous access or basic authentication are also enabled, then things start to go very wrong.
</li>
</ul>
<p>Hope that helps.</p>
