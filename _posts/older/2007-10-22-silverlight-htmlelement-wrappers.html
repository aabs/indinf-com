---
layout: post
title: Silverlight HtmlElement wrappers
date: 2007-10-22 14:56:26.000000000 +10:00
type: post
published: true
status: publish
categories:
- programming
tags: []
meta:
  delicious: a:3:{s:5:"count";s:1:"0";s:9:"post_tags";s:0:"";s:4:"time";s:10:"1321883089";}
  reddit: a:2:{s:5:"count";s:1:"0";s:4:"time";s:10:"1325628310";}
author:
  login: aabs
  email: matthews.andrew@gmail.com
  display_name: Andrew Matthews
  first_name: Andrew
  last_name: Matthews
---
<p>I've been glancing at the HtmlElement class in Silverlight today. It's a nice system, but it's clearly a work in progress. Everything I've said in the past about lumping all of your object model into a single class applies to this. The thing that irritated me was that it wouldn't have been hard for the Silverlight 1.1 team to make the developer experience more palatable even if they were using the one class under the hood.<code><br />
[sourcecode language='csharp']private void Test1()<br />
{<br />
  HtmlDocument document = HtmlPage.Document;<br />
  document.GetElementByID("Submit1").AttachEvent("onclick",<br />
    (object obj, EventArgs args) =><br />
      {<br />
        Text1.SetAttribute("value", (++counter).ToString());<br />
        Text1.SetStyleAttribute("color", "blue");<br />
      }<br />
    );<br />
}[/sourcecode]<br />
</code></p>
<p>Not a lot you can say about this other than "<em>Where's the classes, dude?</em>". It wouldn't have been hard, to give us something like this:<br />
<code><br />
[sourcecode language='csharp']private void Test1()<br />
{<br />
  HtmlDocument document = HtmlPage.Document;<br />
  document.GetElementByID("Submit1").AttachEvent("onclick",<br />
    (object obj, EventArgs args) =><br />
      {<br />
      Text1.Text = (++counter).ToString();<br />
      Text1.Style["color"] = "blue";<br />
      }<br />
    );<br />
}[/sourcecode]<br />
</code></p>
<p>Don't believe me? Well, here's a wrapper around an HtmlElement that refers to an input element of type text.<br />
<code><br />
[sourcecode language='csharp']public class TextBox : HtmlElement<br />
{<br />
  HtmlElement elem;<br />
  public TextBox(HtmlElement elem)<br />
  {<br />
    this.elem = elem;<br />
    Style = new StyleSet(elem);<br />
  }<br />
  public string Text<br />
  {<br />
    get<br />
    {<br />
      return elem.GetAttribute("value");<br />
    }<br />
    set<br />
    {<br />
      elem.SetAttribute("value", value.ToString());<br />
    }<br />
  }<br />
  public StyleSet Style<br />
  {<br />
    get;<br />
    set;<br />
  }<br />
}[/sourcecode]<br />
</code></p>
<p>This class uses a StyleSet class that provides an indexer into the styles of the HtmlElement:<br />
<code><br />
[sourcecode language='csharp']public class StyleSet<br />
{<br />
  private HtmlElement Element{get;set;}<br />
  public StyleSet(HtmlElement elem)<br />
  {<br />
    Element = elem;<br />
  }<br />
  public string this[string key]<br />
  {<br />
    get<br />
    {<br />
      return Element.GetStyleAttribute(key);<br />
    }<br />
    set<br />
    {<br />
      Element.SetStyleAttribute(key, value);<br />
    }<br />
  }<br />
}[/sourcecode]<br />
</code></p>
<p>As you can see, this is pretty simple stuff. All I need to do is provide a conversion when I want to get to the element in my code behind:<br />
<code><br />
[sourcecode language='csharp']public TextBox Text1<br />
{<br />
  get<br />
  {<br />
    HtmlDocument document = HtmlPage.Document;<br />
    return new TextBox(document.GetElementByID("Text1"));<br />
  }<br />
}[/sourcecode]<br />
</code></p>
<p>This wraps the HtmlElement in a TextBox instance, and from there on you can access it in way that appeals to programmers.</p>
